[TOC]

# CH 4 存储器子系统

**本章主要内容：**

（1）存储器的一些基本概念

（2）存储器如何存储信息

（3）用存储芯片构成一定容量的存储器

（4）动态刷新的原理和应用

## 4.1 概述

### 4.1.1 存储系统的层次结构

典型结构:  三级存储体系结构

高速缓存(Cache) –主存 – 外存层次

![image-20221024123321619](https://picgo-1310230783.cos.ap-chengdu.myqcloud.com/img/image-20221024123321619.png)

* Cache:  容量小、速度高
* 主存:  容量较大、速度较高
* 外存:  容量大、速度慢

**CPU访问高速缓存(Cache)和主存的工作原理:** 

![image-20221024124226489](https://picgo-1310230783.cos.ap-chengdu.myqcloud.com/img/image-20221024124226489.png)

### 4..1.3 存储器的分类

#### 1.按存储介质(存储信息的机理)分类

##### (1) 半导体存储器

**静态存储器: 利用双稳态触发器存储信息** 

特点:：有源器件、速度快、非破坏性读出、集成度低、功耗较大、信息易失

**应用场合:主要作高速缓存和小容量主存。**

##### （2）磁表面存储器

**磁层上不同方向的磁化区域表示信息。**

特点：容量大、非破坏性读出、适合长期保存信息、速度慢

**应用场合：适合于做外部存储器。**

##### （3）光盘存储器

**利用激光对光盘表面的记录模进行照射后是否出现融坑表示信息。**

特点：容量很大、非破坏性读出、长期保存信息、速度慢

**应用场合: 适合于作外部存储器。**

## 4.2 半导体存储器

存储信息原理：

**静态存储器SRAM（双极型/静态MOS型）**

依靠双稳态电路内部==交叉反馈机制==存储信息。速度快，功耗较大，适合作**Cache**。

**动态存储器DRAM（动态MOS型）**

依靠==电容==存储电荷的原理存储信息。

功耗较小，容量大，速度较快（比静态存储器慢，比外存快），适合于作主存。

### 4.2.1 静态MOS存储单元与存储芯片

#### 1、六管静态单元

![image-20221024125548981](https://picgo-1310230783.cos.ap-chengdu.myqcloud.com/img/image-20221024125548981.png)

##### （1）组成

$$
\left.
\begin{array}{l}
T_1、T_3：MOS反相器\\
T_2、T_4：MOS反相器
\end{array}
\right\}触发器
$$

**T~5~、T~6~：控制门管**

**Z：字线，**选择存储单元

**$\overline{W}、W$：位线，**完成读写操作

##### （2）定义：

==`0`:T~1~导通==，T~2~截止

==`1`:==T~1~截止，==T~2~导通==

##### （3）工作

字线Z: 加高电平, T5、T6导通, 选中该单元。

**写入:**  在$\overline{W}、W$上分别==加高电平==、低电平, **写1**

​		  在$W、\overline{W}$上分别==加高电平==、低电平, **写0**

**读出：**先将$\overline{W}、W$充电至高电平, 再根据$W、\overline{W}$上有无放电电流, **读1或0** ：

![image-20221024130808049](https://picgo-1310230783.cos.ap-chengdu.myqcloud.com/img/image-20221024130808049.png)

原信息为`1`**(即T~1~截止, T~2~导通)**，则W通过T~6~和T~2~对地放电,，使W上有电流,，经放大为`1`信号。

原信息为`0`**(即T~1~导通, T~2~截止)**，则$\overline{W}$通过T~5~和T~1~对地放电， 使W上有电流,，经放大为`0`信号。

##### （4）保持

**Z:  加低电平,  T5、T6截止, 该单元未选中, 保持原状态。**

只要电源正常, 保证向导通管提供电流, 便能维持一管导通, 另一管截止的状态不变。

**所以称为:  静态存储单元**

**静态单元是非破坏性读出, 读出后不需重写。**

>**上述存放1位二进制信息的存储电路称为一个位单元**

### 4.2.2 动态MOS存储单元与存储芯片

#### 1.四管单元

![image-20221024132804074](https://picgo-1310230783.cos.ap-chengdu.myqcloud.com/img/image-20221024132804074.png)

##### （1）组成

==T~1~、T~2~：记忆管==

C~1~、C~2~：栅极电容

==T~3~、T~4~：控制门管==

==Z：字线==

$\overline{W}、W$：位线

##### （2）定义

`0`:==T~1~导通==，T~2~截止==（C~1~有电荷，C~2~无电荷）==

`1`:T~1~截止，==T~2~导通（C1无电荷，C2有电荷）==

##### （3）工作

Z：加高电平，T3、T4导通，选中该单元。

**写入：**在$\overline{W}、W$上分别加高、低电平，写1/0。

**读出：**$\overline{W}、W$先预充电至高电平，断开充电回路，再根据W、W上有无电流，读1/0。

##### (4)保持

==Z：加低电平，需定期向电容补充电荷（动态刷新），所以称动态。==

==四管单元是非破坏性读出，读出过程即实现刷新。==

### 4.2.4 动态存储器的刷新

#### 1.刷新定义和原因

**定义：**定期

**注意刷新与重写的区别：**

**刷新**： **非破坏性读出**的动态M，需补充电荷以保持原来的信息。

**重写：** **破坏性读出**后重写，以恢复原来的信息

#### 2.最大刷新间隔

==2ms==，在此期间，必须对所有动态单元刷新一遍。

#### 3.刷新方法

==按行读==

刷新一行所需的时间——==刷新周期==

刷新一块芯片所需的==刷新周期数==由芯片矩阵的==行数==决定。
$$
对主存的访问\left\{
\begin{array}{l}
CPU访存：由CPU提供行、列地址
\\动态芯片刷新：由刷新地址计数器提供行地址，定时刷新
\end{array}
\right.
$$

#### 4.刷新周期的安排方式

##### （1）集中刷新

==2ms内集中安排所有刷新周期。==

> 用在实时要求不高的场合

##### （2）分散刷新

==各刷新周期分散安排在存取周期中==

> 用在低速系统中

##### （3）异步刷新

==各刷新周期分散安排在2ms内==

每隔一段时间刷新一行

## 4.2 主存储器组织

**应解决的问题：**

* 芯片的选用——多大容量，位数，多少片
* 地址分配——将CPU提供的全部地址空间的哪些地址空间分配给所设计的存储器，怎样分配，电路中如何体现
* 片选逻辑——如何产生芯片所需片选信号
* 信号线的连接——所有信号线如何连接

线路连接的原理框图：

![image-20221025204006235](https://picgo-1310230783.cos.ap-chengdu.myqcloud.com/img/image-20221025204006235.png)

### 4.2.3 半导体存储器逻辑设计

**需解决：芯片的选用、地址分配与片选逻辑、信号线的连接**

**例1.用2114（1K×4）SRAM芯片组成容量为4K×8的存储器。地址总线A15～A0（低）,双向数据总线D7～D0（低）,读/信号线$R/ \overline{W}$。给出芯片地址分配与片选逻辑,并画出M框图。**

**1.计算芯片数**

法一：先扩展位数，再扩展单元数。
$$
\left.
\begin{array}{l}
2片1K×4 \to 1K×8 \\
4组1K×8 \to 4K×8
\end{array}
\right\}8片
$$
法二：先扩展单元数，再扩展位数

**2.地址分配与片选逻辑**

![image-20221025205801503](https://picgo-1310230783.cos.ap-chengdu.myqcloud.com/img/image-20221025205801503.png)

存储空间分配：4KB存储器在16位地址空间（64KB）中占据任意连续区间。

![image-20221025210438005](https://picgo-1310230783.cos.ap-chengdu.myqcloud.com/img/image-20221025210438005.png)

**3.连接方式**

（1）扩展位数

（2）扩展单元数

（3）连接控制线

![image-20221025210645591](https://picgo-1310230783.cos.ap-chengdu.myqcloud.com/img/image-20221025210645591.png)

（4）形成片选逻辑电路

**例2.某半导体存储器，按字节编址。其中，0000H～07FFH为ROM区，选用EPROM芯片（2KB/片）；0800H～13FFH为RAM区，选用RAM芯片（2KB/片和1KB/片）。地址总线A15～A0（低）。给出地址分配和片选逻辑。**

**1.计算容量和芯片数**

ROM区：2KB       

RAM区：3KB       

共3片       

**2.地址分配与片选逻辑**

**存储空间分配：**先安排大容量芯片（放地址低端），再安排小容量芯片。便于拟定片选逻辑。

![image-20221025212807760](https://picgo-1310230783.cos.ap-chengdu.myqcloud.com/img/image-20221025212807760.png)

### 关于 全译码、部分译码和线译码

#### 全译码

![image-20221027225210347](https://picgo-1310230783.cos.ap-chengdu.myqcloud.com/img/image-20221027225210347.png)

**将除了与芯片连接的地址以外的所有高位地址用于译码产生片选信号, 称为全译码方式**。

#### 部分译码

![image-20221027225229146](https://picgo-1310230783.cos.ap-chengdu.myqcloud.com/img/image-20221027225229146.png)

**将除了与芯片连接的地址外的部分高位地址用于译码产生片选信号, 称为部分译码方式。**

#### 线译码

![image-20221027225245370](https://picgo-1310230783.cos.ap-chengdu.myqcloud.com/img/image-20221027225245370.png)

**用一条地址线的高低电平来区分两组地址范围, 并作为片选信号,  称为线译码方式。**

#### 三种译码方式的应用场合:

* 所设计存储器**达到**(或接近达到)CPU提供的**全部存储空间**时, 必须用**全译码**, 且任何时候都可使用全译码。
* 所设计存储器**未达到**CPU提供的全部存储空间时, 可以用**部分译码**或**线译码**。
* 可采用全译码与部分译码**相结合**的方式, 即部分芯片用全译码,  另一些芯片采用部分译码。

#### 三种译码方式的优缺点:

* 全译码电路较复杂,  部分译码和线译码相对简单。
* 部分译码和线译码时,  存储器扩展比较困难。

​            





